---
title: "Making maps of Ireland in R"
author: "Brendan O'Dowd"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction

This guide uses maps from my GitHub page produced using shapefiles from [OSi](https://data-osi.opendata.arcgis.com/) and [OSNI](https://www.spatialni.gov.uk/).
 
Two packages are used throughout, they are [tidyverse](https://tidyverse.tidyverse.org/) (actually a collection of packages) and [sf](https://r-spatial.github.io/sf/), which stands for simple features. To install any package run ```install.packages("package_name")```.

To start, we will need to load both of these packages.

```{r packages , message=FALSE}
library(tidyverse)
library(sf)
```

## Importing maps

You **should** be able to import my maps directly from the web, using the following, which will create an object called ```lea_166```. This is an sf object, it is a special type of dataframe that has a column called geometry which contains the coordinates for the shapes. This is a map of the 166 Local Electoral Areas in Ireland, plus the outline for Northern Ireland, so there are 167 shapes in total and 167 rows in ```lea_166```.

I say **should** above because your organisation might not allow R to access the web in this way. If that's the case then you can navigate to the URL in the ```st_read()``` function, and save that page locally as a .geojson file. Then use the file location on your PC as the argument for ```st_read()```.


```{r import_map , message=FALSE , results="hide"}
lea_166 <- st_read("https://raw.githubusercontent.com/brendanjodowd/maps/main/lea_166.geojson")
```

We will be able to use this map to create other maps, such as county outlines and NUTS 3 region outlines, as we shall see.

Let's take a quick look at the map that we now have using ggplot (ggplot is one of the packages within tidyverse which is very useful for making all kinds of nice plots).

```{r first_plot , message=FALSE , results="hide"}
ggplot() + geom_sf(data= lea_166)
```

This structure of using ```ggplot()``` followed by ```geom_XXX()``` will be familiar to users of ggplot. 

Note that the following piece of code is equivalent, and doesn't require ```data = ```:

```{r first_plot_alternative , eval=FALSE }
ggplot(lea_166) + geom_sf()
```

I will be using the first format because later I will be using multiple ```geom_sf()``` functions to build up a plot in layers, and I find that the dataframe being used is less ambiguous that way. 

 


## Aggregating up for counties and NUTS regions

Maps for counties, admin areas, NUTS2 and NUTS3 regions can be produced using either of the shapefiles provided. To produce a map of counties, for example, use:

```{r aggregating , message=FALSE , results="hide"}
county_map <- lea_166 %>% 
  group_by(COUNTY) %>% 
  summarise(geometry = st_union(geometry) , AREA=sum(AREA))
```





You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
